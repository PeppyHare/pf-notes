



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>20.2 - Governing Equations - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700|IBM+Plex+Mono">
        <style>body,input{font-family:"IBM Plex Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"IBM Plex Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/dark_theme.css">
    
      <link rel="stylesheet" href="../stylesheets/codehilite.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#governing-equations" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="My Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon">book</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              My Docs
            </span>
            <span class="md-header-nav__topic">
              20.2 - Governing Equations
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/PeppyHare/pf-notes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PeppyHare/pf-notes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="My Docs" class="md-nav__button md-logo">
      
        <i class="md-icon">book</i>
      
    </a>
    My Docs
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/PeppyHare/pf-notes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PeppyHare/pf-notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      1 - The Plasma State
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        1 - The Plasma State
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch1-1/" title="1.1 - Definition of Plasma" class="md-nav__link">
      1.1 - Definition of Plasma
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch1-2/" title="1.2 - Particle motion in EM fields" class="md-nav__link">
      1.2 - Particle motion in EM fields
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Physics of Fusion Plasmas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Physics of Fusion Plasmas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-0/" title="Rules of thumb" class="md-nav__link">
      Rules of thumb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Review
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Review
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-1/" title="Statistical Mechanics" class="md-nav__link">
      Statistical Mechanics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-2/" title="Review of E&M" class="md-nav__link">
      Review of E&M
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-3/" title="Lagrange Multipliers" class="md-nav__link">
      Lagrange Multipliers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Plasma Properties
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Plasma Properties
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch11-1/" title="Wall-supported Plasma" class="md-nav__link">
      Wall-supported Plasma
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch11-2/" title="Collisions" class="md-nav__link">
      Collisions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch11-3/" title="Oscillations" class="md-nav__link">
      Oscillations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Plasma Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Plasma Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch12-1/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch12-2/" title="Plasma Models" class="md-nav__link">
      Plasma Models
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Introduction to Compressible CFD
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Introduction to Compressible CFD
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1" checked>
    
    <label class="md-nav__link" for="nav-5-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-1/" title="20.1 - Introduction" class="md-nav__link">
      20.1 - Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        20.2 - Governing Equations
      </label>
    
    <a href="./" title="20.2 - Governing Equations" class="md-nav__link md-nav__link--active">
      20.2 - Governing Equations
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#2022-the-euler-equations" title="20.2.2 The Euler Equations" class="md-nav__link">
    20.2.2 The Euler Equations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-3/" title="20.3 - Reduced Models" class="md-nav__link">
      20.3 - Reduced Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-4/" title="20.4 - Equation Types" class="md-nav__link">
      20.4 - Equation Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-5/" title="20.5 - Panel Method" class="md-nav__link">
      20.5 - Panel Method
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Finite Differencing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Finite Differencing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-1/" title="21.1 - Finite Difference Algorithms" class="md-nav__link">
      21.1 - Finite Difference Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-2/" title="21.2 - Explicit Finite Difference Algorithms" class="md-nav__link">
      21.2 - Explicit Finite Difference Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-3/" title="21.3 - Finite Difference and Finite Volume Methods" class="md-nav__link">
      21.3 - Finite Difference and Finite Volume Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-4/" title="21.4 - Implicit Algorithms" class="md-nav__link">
      21.4 - Implicit Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-5/" title="21.5 - Numerical Boundary Conditions" class="md-nav__link">
      21.5 - Numerical Boundary Conditions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-6/" title="21.6 - Method of Lines" class="md-nav__link">
      21.6 - Method of Lines
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#2022-the-euler-equations" title="20.2.2 The Euler Equations" class="md-nav__link">
    20.2.2 The Euler Equations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/PeppyHare/pf-notes/edit/master/docs/ch20-2.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="governing-equations"><strong>Governing Equations</strong></h1>
<p>Continuity</p>
<p>
<script type="math/tex; mode=display">
\pdv{\rho}{t} + v \cdot \grad \rho = - \rho \grad \cdot v
</script>
</p>
<p>Momentum:</p>
<p>
<script type="math/tex; mode=display">
\rho \left( \pdv{v}{t} + v \cdot \grad v\right) + \grad p - \frac{1}{\mu_0} (\curl \vec B) \cross \vec B = \div  \vec T 
</script>
<script type="math/tex; mode=display">
\vec T = \text{ viscous stress tensor }
</script>
<script type="math/tex; mode=display">
\frac{1}{\mu_0} \curl \vec B = \vec j = \text{ current density }
</script>
</p>
<p>Magnetic Field
<script type="math/tex; mode=display">
\pdv{B}{t} - \curl ( v \cross B) = - \curl \left[ \frac{\eta}{\mu_0} (\curl \vec B) \right]
</script>
<script type="math/tex; mode=display">
\eta = \text{ electrical resistivity }
</script>
</p>
<p>Energy:</p>
<p>
<script type="math/tex; mode=display">
\begin{align*}
\rho \left( \pdv{\mathscr{E}}{t} + v \cdot \grad \mathscr{E} \right) + p \div v & = \div \left( v \cdot \vec T \right) & \\
& + \div ( k \div T) \qquad \text{ (thermal conduction) }& \\
& + \frac{\eta}{\mu_0 ^2} (\curl B )^2 \qquad \text{ (resistive heating) } &
\end{align*}
</script>
<script type="math/tex; mode=display">
\mathscr{E} = \text{ specific internal energy}
</script>
<script type="math/tex; mode=display">
\rho \mathscr{E} = \frac{p}{\gamma - 1}
</script>
</p>
<p>These are the governing equations for magnetohydrodynamics (MHD). It's important to understand where they come from. Starting from the Boltzmann equation, which describes how a distribution evolves over time</p>
<p>
<script type="math/tex; mode=display">
\pdv{f}{t} + \vec v \cdot \pdv{f}{\vec x} + \vec a \pdv{f}{\vec v} = \left. \pdv{f}{t} \right|_{\text{collisions}}
</script>
</p>
<p>We take moments of <script type="math/tex"> \vec v </script> of the Boltzmann equation to get all of the above:</p>
<p>
<script type="math/tex; mode=display">
\vec u (\vec x , t) = \frac{\int \vec v f( \vec x , \vec v, t) \dd \vec v}{\int f(\vec x, \vec v, t) \dd \vec v}
</script>
</p>
<p>The 0th moment gives the conservation of mass relation, since . The Knudsen number <script type="math/tex"> Kn </script> is the mean free path between collisions 
<script type="math/tex; mode=display">
Kn = \frac{ \lambda_{mfp}}{L}
</script>
When the Knudsen number is sufficiently small, these equations work well. When Kn becomes larger than the simulation volume, then the equations of fluid dynamics break down and we get non-Maxwellian phenomena. Also, if <script type="math/tex"> L </script> is very small (for example, a powerful shock), we'll probably miss something.</p>
<p>When taking moments, notice that each moment will introduce the next moment</p>
<p>
<script type="math/tex; mode=display">
\pdv{}{t} \int \vec v ^{n} f \dd \vec v + \int \vec v ^{n+1} f \dd \vec v
</script>
</p>
<p>We get to stop when we define a closure relation that relates moments to higher moments. For example, the ideal gas law is a closure relation, since it relates temperature (<script type="math/tex"> \mathscr{E} </script> to density. Implicit in these equations are the closure relations that we need to keep in mind.</p>
<p>If we drop all terms with B and the magnetic field equation, then we get the Navier-Stokes equations. These equations are a system and must be solved self-consistently. The RHS of each equation represents non-ideal contributions due to self collisions. Those include viscosity, resistivity, and conduction.</p>
<p>Using vector identities and the fact that <script type="math/tex"> \div B = 0 </script>, we can re-write the equations in <strong>conservative form</strong>.</p>
<p>
<script type="math/tex; mode=display">
\pdv{\rho}{t} + \div (\rho v) = 0
</script>
</p>
<p>
<script type="math/tex; mode=display">
\pdv{(\rho v)}{t} + \div \left[\rho v v - \frac{BB}{\mu_0} + \vec 1 \left( \frac{B^2}{2 \mu_0} + p \right) \right] = \div \vec T
</script>
<script type="math/tex; mode=display">
\pdv{B}{t} + \div [v B - B v] = \div \left( \frac{\eta}{\mu_0} \grad B \right)
</script>
<script type="math/tex; mode=display">
\pdv{e}{t} + \div \left[ \left( e + p + \frac{B^2}{2 \mu_0} \right) v - \frac{(B \cdot v) B}{\mu_0} \right] = \div \left[ v \cdot \vec T + k \grad T - \frac{\eta}{\mu_0} ( \curl B) \cross B \right]
</script>
where the total energy <script type="math/tex"> e = \frac{p}{\gamma - 1} + \frac{rho v^2}{2} + \frac{B^2}{2 \mu_0 } </script>.</p>
<p>As a quick refresher on dyad notation, we say <script type="math/tex"> \vec A \vec B </script> is notation for</p>
<p>
<script type="math/tex; mode=display">
\vec A \vec B = \begin{bmatrix} A_x B_x & A_x B_y & A_x B_z \\ A_y B_x & A_y B_y & \ldots \\
\ldots & \ldots & \ldots & \end{bmatrix}
</script>
For that reason, sometimes it'll be written as a matrix multiplication <script type="math/tex"> \vec A \vec B^T </script>
<script type="math/tex; mode=display">
\vec A \vec B^T = \begin{bmatrix} A_x \\ A_y \\ A_z \end{bmatrix} \begin{bmatrix} B_x & B_y & B_z \end{bmatrix}
</script>
</p>
<p>In compact form,
<script type="math/tex; mode=display">
\pdv{Q}{t} + \div \vec F = \div \vec F_p \quad \text{(parabolic)}
</script>
or
<script type="math/tex; mode=display">
\pdv{Q}{t} + \pdv{\vec F}{x} + \pdv{\vec G}{y} + \pdv{\vec H}{z} = \pdv{\vec F_p}{x} + \pdv{\vec G_p}{y} + \pdv{\vec H_p}{z}
</script>
</p>
<p>Now, we can re-write the governing equations in a form that's easier to work with, called <strong>conservation form</strong>. This form involves relating the time derivative of a quantity we are interested in to the divergence of a flux:</p>
<p>
<script type="math/tex; mode=display">
\pdv{Q}{t} = - \div \vec F
</script>
</p>
<p>Our governing relations are not in conservation form, but they can be. Take the conservation of mass relation</p>
<p>
<script type="math/tex; mode=display">
\pdv{\rho}{t} = - \div ( \rho \vec v)
</script>
</p>
<p>Writing our expressions in conservation form helps to ensure that numerical codes replicate real physics. If our simulation does not conserve something like mass or momentum due to some numerical errors, we're not likely to get a physical result from the simulation.</p>
<p>On to the conservation of momentum, combining with our mass conservation relation</p>
<p>
<script type="math/tex; mode=display">
\pdv{}{t}(\rho \vec v) + \div \left[ \rho \vec v \vec v - \frac{\vec B \vec B}{\mu_0} + (\frac{B^2}{2 \mu_0} + p ) \vec 1 \right] = \div \vec T
</script>
</p>
<p>and the magnetic field equation</p>
<p>
<script type="math/tex; mode=display">
\pdv{\vec B}{t} + \div \left[ \vec v \vec B - \vec B \vec v \right] = \div \left[ \frac{\eta}{\mu_0} \grad \vec B \right]
</script>
</p>
<p>and the energy relation</p>
<p>
<script type="math/tex; mode=display">
\pdv{e}{t} + \div \left[ \left(e + p + \frac{B^2}{2 \mu_0}\right) \vec v - \frac{( \vec B \cdot \vec v) \vec B}{\mu_0} \right] = \div \left[ \ldots \right]
</script>
<script type="math/tex; mode=display">
\text{ total energy } \quad e = \frac{p}{\gamma - 1} + \frac{\rho v^2}{2} + \frac{B^2}{2\mu_0}
</script>
</p>
<p>So all of our governing equations can be written in conservation form. We can get to a more compact form which looks like</p>
<p>
<script type="math/tex; mode=display">
\pdv{\overline{Q}}{t} + \div \overline{\overline{F}} = \div \overline{\overline{F_p}}
</script>
</p>
<p>where <script type="math/tex"> \overline{Q} </script> is just the vector containing all of our scalar conserved quantities, and <script type="math/tex"> \overline{\overline{F} }</script> is a vector of all of our flux vectors.</p>
<p>
<script type="math/tex; mode=display">
\overline{Q} = \begin{bmatrix} \rho \\ \rho \mu \\ \rho v \\ \rho w \\ B_x \\ B_y \\ B_z \\ e \end{bmatrix}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\overline{\overline{F}} = \vec F + \vec G + \vec H = \overline{\overline{F_x}} + \overline{\overline{F_y}} + \overline{\overline{F_z}}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\overline{F} = \begin{bmatrix} \rho u \\
\rho u^2 - B^2 _x / 2 \mu + p \\
\rho u v - B_x B_y / \mu_0 \\
\rho u w - B_x B_z / \mu \\
0 \\
u B_y - B_x v \\
u B_z - B_x w \\
(e + p + B^2 / 2 \mu_0 )u - \frac{\vec B \cdot \vec v}{\mu_0} B_x 
\end{bmatrix} = \text{ flux vector (x-component) }
</script>
</p>
<p>We can similarly calculate the other factors <script type="math/tex"> \overline{G} </script> and <script type="math/tex"> \overline{H} </script>. Now let's move on to <script type="math/tex"> \overline{F_p} </script>, the parabolic flux vector (as opposed to the hyperbolic fluxes <script type="math/tex"> \overline{F} </script>). These fluxes typically come from "non-ideal" effects.</p>
<p>
<script type="math/tex; mode=display">
\overline{F_p} = \begin{bmatrix} 0 \\
2 \mu \left(\pdv{u}{x} - \frac{ \div \vec v}{3} \right) \\
\mu \left( \pdv{\mu}{y} + \pdv{v}{x} \right) \\
\mu \left( \pdv{u}{z} + \pdv{w}{z} \right) \\
\frac{\eta}{\mu_0} \pdv{B_x}{x} \\
\frac{\eta}{\mu_0} \pdv{B_y}{x} \\
\frac{\eta}{\mu_0} \pdv{B_z}{x} \\
u \vec T _{xx} +  v T_{yx} + w T_{zx} + k \pdv{T}{x} - \frac{\eta}{\mu_0} \left[ ( \curl B)_y B_z - ( \curl B)_z B_y \right]
\end{bmatrix}
</script>
</p>
<h2 id="2022-the-euler-equations"><strong>20.2.2</strong> The Euler Equations</h2>
<p>If we have a fluid which is unmagnetized, inviscid, and thermal conductivity is zero, we are left with the Euler equations
<script type="math/tex; mode=display">
\pdv{Q}{t} + \pdv{F}{x} + \pdv{G}{y} + \pdv{H}{z} = 0
</script>
</p>
<p>or, in 2 dimensions</p>
<p>
<script type="math/tex; mode=display">
\pdv{Q}{t} + \pdv{F}{x} + \pdv{G}{y} = 0
</script>
<script type="math/tex; mode=display">
Q = \begin{bmatrix} \rho \\ \rho u \\ \rho v \\ e \end{bmatrix}
</script>
<script type="math/tex; mode=display">
F = \begin{bmatrix} \rho u \\ \rho u ^2 + p \\ \rho u v \\ u (e + p) \end{bmatrix}
</script>
</p>
<p>
<script type="math/tex; mode=display">
G = \begin{bmatrix} \rho v \\ \rho u v \\ \rho v^2 + p \\ v(e + p) \end{bmatrix}
</script>
</p>
<p>The Euler equations are the inviscid Navier-Stokes equations, and they exhibit many of the nonlinearities that the full N-S and other more complicated flows do, but with a much simpler form. Solution of the Euler equations represents an important advance for any algorithm. Some such important nonlinearities are shockwaves, contact discontinuities, rarefications. It turns out that most of those parabolic fluxes make the situation easier from a CFD standpoint, because they are dissipating effects which actually serve to suppress instabilities.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ch20-1/" title="20.1 - Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                20.1 - Introduction
              </span>
            </div>
          </a>
        
        
          <a href="../ch20-3/" title="20.3 - Reduced Models" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                20.3 - Reduced Models
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.2ba8dec4.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../extra.js"></script>
      
    
  </body>
</html>