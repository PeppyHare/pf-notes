



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>21.4 - Implicit Algorithms - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700|IBM+Plex+Mono">
        <style>body,input{font-family:"IBM Plex Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"IBM Plex Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/dark_theme.css">
    
      <link rel="stylesheet" href="../stylesheets/codehilite.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#implicit-algorithms" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="My Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon">book</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              My Docs
            </span>
            <span class="md-header-nav__topic">
              21.4 - Implicit Algorithms
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/PeppyHare/pf-notes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PeppyHare/pf-notes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="My Docs" class="md-nav__button md-logo">
      
        <i class="md-icon">book</i>
      
    </a>
    My Docs
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/PeppyHare/pf-notes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PeppyHare/pf-notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      1 - The Plasma State
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        1 - The Plasma State
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch1-1/" title="1.1 - Definition of Plasma" class="md-nav__link">
      1.1 - Definition of Plasma
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch1-2/" title="1.2 - Particle motion in EM fields" class="md-nav__link">
      1.2 - Particle motion in EM fields
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Physics of Fusion Plasmas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Physics of Fusion Plasmas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-0/" title="Rules of thumb" class="md-nav__link">
      Rules of thumb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Review
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Review
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-1/" title="10.1 - Statistical Mechanics" class="md-nav__link">
      10.1 - Statistical Mechanics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-2/" title="10.2 - Review of E&M" class="md-nav__link">
      10.2 - Review of E&M
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Plasma Properties
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Plasma Properties
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch11-1/" title="11.1 - Wall-supported Plasma" class="md-nav__link">
      11.1 - Wall-supported Plasma
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch11-3/" title="11.3 - Oscillations" class="md-nav__link">
      11.3 - Oscillations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Introduction to Compressible CFD
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Introduction to Compressible CFD
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-1/" title="20.1 - Introduction" class="md-nav__link">
      20.1 - Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-2/" title="20.2 - Governing Equations" class="md-nav__link">
      20.2 - Governing Equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-3/" title="20.3 - Reduced Models" class="md-nav__link">
      20.3 - Reduced Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-4/" title="20.4 - Equation Types" class="md-nav__link">
      20.4 - Equation Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-5/" title="20.5 - Panel Method" class="md-nav__link">
      20.5 - Panel Method
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Finite Differencing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Finite Differencing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-1/" title="21.1 - Finite Difference Algorithms" class="md-nav__link">
      21.1 - Finite Difference Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-2/" title="21.2 - Explicit Finite Difference Algorithms" class="md-nav__link">
      21.2 - Explicit Finite Difference Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch21-3/" title="21.3 - Finite Difference and Finite Volume Methods" class="md-nav__link">
      21.3 - Finite Difference and Finite Volume Methods
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        21.4 - Implicit Algorithms
      </label>
    
    <a href="./" title="21.4 - Implicit Algorithms" class="md-nav__link md-nav__link--active">
      21.4 - Implicit Algorithms
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#implicit-ftcs-backward-euler" title="Implicit FTCS (Backward Euler)" class="md-nav__link">
    Implicit FTCS (Backward Euler)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#theta-algorithm" title="Theta Algorithm" class="md-nav__link">
    Theta Algorithm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" title="Boundary Conditions" class="md-nav__link">
    Boundary Conditions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#implicit-ftcs-backward-euler" title="Implicit FTCS (Backward Euler)" class="md-nav__link">
    Implicit FTCS (Backward Euler)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#theta-algorithm" title="Theta Algorithm" class="md-nav__link">
    Theta Algorithm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" title="Boundary Conditions" class="md-nav__link">
    Boundary Conditions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/PeppyHare/pf-notes/edit/master/docs/ch21-4.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="implicit-algorithms">Implicit Algorithms</h1>
<p>Stability conditions are often related to the CFL number, and stability analysis of explicit algorithms usually require us to set a limit to small CFL</p>
<p>
<script type="math/tex; mode=display">
\left| \frac{a \Delta x}{\Delta t} \right| \leq 1
</script>
</p>
<p>For a given grid, this effectively sets a limit on the time step. The time step can be no larger than the grid spacing divided by the propagation constant <script type="math/tex"> \Delta t \leq \Delta x / |a| </script>. As an example, say we have a device of interest that is 1 meter long, and we want a grid resolution such that we can resolve features that are 1mm in size. Say the problem domain is flow over an airfoil</p>
<p>
<script type="math/tex; mode=display">
c_s \approx 1000 m/s
</script>
<script type="math/tex; mode=display">
\Delta x / a \approx 10^{-6}
</script>
</p>
<p>The time step is limited to less than a microsecond! If the system has any appreciable size, we are probably going to need a lot of compute time to simulate any substantial time scale.</p>
<p>If there are boundary layers that need to be resolved, even finer grid resolution is required. The limit on <script type="math/tex"> \Delta t </script> comes from the minimum grid resolution, so non-uniform grid spacings can even further limit the possible time step size.</p>
<p>Such strict constraints on the possible time step can make explicit finite difference methods unfeasible. This motivates <strong>implicit</strong> methods in which we construct the solution based on data that is not yet available</p>
<p>
<script type="math/tex; mode=display">
u^{n+1} = f(u^n, u^{n+1})
</script>
</p>
<h2 id="implicit-ftcs-backward-euler">Implicit FTCS (Backward Euler)</h2>
<p>As an example, let's devise an implicit algorithm based on FTCS where we evaluate <script type="math/tex"> \Delta x </script> at time <script type="math/tex"> n+1 </script>
</p>
<p>
<script type="math/tex; mode=display">
\frac{u_j ^{n+1} - u_j ^n}{\Delta t} + a\frac{ u_{j+1} ^{n+1} - u_{j-1} ^{n+1}}{2 \Delta x} = 0 
</script>
</p>
<p>
<script type="math/tex; mode=display">
\rightarrow u_j ^{n+1} = u_j - \frac{a \Delta t}{\Delta x} \left( \frac{ u_{j+1} ^{n+1} - u_{j-1} ^{n+1}}{2} \right)
</script>
</p>
<p>Accuracy: <script type="math/tex"> O(\Delta t, \Delta x^2) </script>
</p>
<p>von Neumann Stability analysis:</p>
<p>
<script type="math/tex; mode=display">
\varepsilon_j ^{n+1} = \varepsilon_j ^n - \frac{ a \Delta t}{\Delta x} \left( \frac{ \varepsilon_{j+1} ^{n+1} - \varepsilon_{j-1} ^{n+1} }{2} \right)
</script>
<script type="math/tex; mode=display">
\varepsilon_j ^n = V^n e^{i k j \Delta x}
</script>
<script type="math/tex; mode=display">
\frac{ V^{n+1}}{V^n} \left[ 1 + \frac{ a \Delta t}{2\Delta x} \left( e^{i k \Delta x} - e^{- i k \Delta x} \right) \right] = 1
</script>
<script type="math/tex; mode=display">
\rightarrow  \left| \frac{V^{n+1}}{V^n} \right| = G = \sqrt{ \frac{1}{1 + \frac{a^2 \Delta t^2}{\Delta x^2} \sin ^2(k \Delta x)}}
</script>
</p>
<p>So the backward Euler method is unconditionally stable! Great, we've got an algorithm that's unconditionally stable. But how do we actually solve it?</p>
<p>We can write backward Euler as a matrix equation <script type="math/tex"> \overline{A} \overline{x} = \overline{b} </script> where</p>
<ul>
<li>
<script type="math/tex"> \overline{A} </script> = operator matrix</li>
<li>
<script type="math/tex"> \overline{x} </script> = solution vector (<script type="math/tex"> u^{n+1} </script>)</li>
<li>
<script type="math/tex"> \overline{b} </script> = inhomogeneity vector (<script type="math/tex"> u^n </script>)</li>
</ul>
<p>Getting to the matrix expression, re-write Backward Euler by putting all of the terms at future times on the left-hand side (in order of increasing <script type="math/tex"> j </script> index), and all of the terms at known times on the right-hand side.</p>
<p>
<script type="math/tex; mode=display">
- \frac{ a \Delta t}{\Delta x} u_{j-1} ^{n+1} + u_j ^{n+1} + \frac{a \Delta t}{2 \Delta x} u^{n+1} _{j+1} = u_n ^n
</script>
</p>
<p>
<script type="math/tex; mode=display">
\overline{A} \overline{x} = \overline{b}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\begin{bmatrix}
1 & \left( \frac{a \Delta t}{2 \Delta x} \right) & 0 & 0 & \ldots & \ldots & \ldots \\
\ldots & \ldots & \ldots & \ldots & \ldots & \ldots & \ldots \\
\ldots & 0 & - \left( \frac{a \Delta t}{2 \Delta x} \right) & 1 & \left( \frac{a \Delta t}{2 \Delta x} \right) & 0 & \ldots  \\
\ldots & \ldots & \ldots & \ldots & \ldots & \ldots & \ldots \\
\ldots &\ldots & \ldots & \ldots & 0 & - \left( \frac{a \Delta t}{2 \Delta x} \right) & 1
\end{bmatrix}
\begin{bmatrix}
u_1 ^{n+1} \\
\ldots \\
u_{j-1} ^{n+1} \\
u_j ^{n+1} \\
u_{j+1} ^{n+1} \\
\ldots \\
u_J ^{n+1}
\end{bmatrix} = \begin{bmatrix}
u_1 ^{n} \\
\ldots \\
u_{j-1} ^{n} \\
u_j ^{n} \\
u_{j+1} ^{n} \\
\ldots \\
u_J ^{n}
\end{bmatrix} 
</script>
</p>
<p>In matrix form, it's easy to see how we can get to <script type="math/tex"> \overline{x} </script> from <script type="math/tex"> \overline{b} </script>
</p>
<p>
<script type="math/tex; mode=display">
\rightarrow  x = A^{-1} b
</script>
</p>
<p>In this case the operator matrix is tridiagonal, so it can be easily inverted.</p>
<h2 id="theta-algorithm">Theta Algorithm</h2>
<p>We can get a more accurate form if we combine Backward Euler with FTCS with some multiplier</p>
<p>
<script type="math/tex; mode=display">
u_j ^{n+1} + \Theta \frac{ a \Delta t}{\Delta x} \left( \frac{ u_{j+1} ^{n+1} - u_{j-1} ^{n+1}}{2} \right) = u_j ^n - (1 - \Theta) \frac{ a \Delta t}{\Delta x} \left( \frac{ u_{j+1}^n - u_{j-1} ^n}{2} \right) 
</script>
</p>
<p>We call this method the <script type="math/tex"> \Theta </script>-method. If we write in terms of our differential operators,</p>
<p>
<script type="math/tex; mode=display">
\Delta _t u^n +a (1 - \Theta) \delta _x u^n + a \Theta \delta _x u^{n+1} = 0
</script>
</p>
<p>As we'll see, <script type="math/tex"> \Theta = [0,1] </script> for stability. </p>
<ul>
<li>
<script type="math/tex"> \Theta = 1 </script>: is just Backward Euler</li>
<li>
<script type="math/tex"> \Theta = 0 </script>: we've just got FTCS</li>
<li>
<script type="math/tex"> \Theta = 1/2 </script>: This is called Crank-Nicolson</li>
</ul>
<p>We find that by using <script type="math/tex"> \Theta \neq 1 </script>, we can improve the performance (condition number of operator matrix) by making the operator matrix more diagonally dominant. It can also reduce diffusion (possibly making it better for shock capture), with the flip-side being an increase in dispersion. It can also increase the temporal accuracy -- we find that for <script type="math/tex"> \Theta = 1/2 </script>, the accuracy is <script type="math/tex"> O(\Delta t^2, \Delta x^2) </script>
</p>
<h2 id="boundary-conditions">Boundary Conditions</h2>
<p>The linear advection equation is</p>
<p>
<script type="math/tex; mode=display">
\pdv{u}{t} + a \pdv{u}{x} = 0
</script>
</p>
<p>For it to be a well-posed mathematical problem, you also need the Cauchy data (boundary and initial conditions). From the order of the differential operators, we know that we need one boundary condition (constraint on <script type="math/tex"> u(x_b) </script> for all <script type="math/tex"> t </script> ) and one initial condition (constraint on <script type="math/tex"> u(x) </script> at <script type="math/tex"> t = 0 </script>).</p>
<p>If we are solving the heat diffusion equation</p>
<p>
<script type="math/tex; mode=display">
\pdv{T}{t} = \alpha \pdv{^2 T}{x^2}
</script>
</p>
<p>Then we need 1 initial condition and 2 boundary conditions.</p>
<p>Back to the linear advection equation, if we say</p>
<p>
<script type="math/tex; mode=display">
u(t = 0, x) = f(x) \quad \text{and} \quad u(t, x=0) = g_D(t) \qquad \text{(Dirichlet BC)}
</script>
For wave speeds less than 0 (<script type="math/tex"> a < 0 </script>), then we would instead specify <script type="math/tex"> u(t, x=L) </script>.</p>
<p>The way boundary conditions are implemented in the Forward Euler algorithm (as an example):</p>
<p>
<script type="math/tex; mode=display">
u_j ^{n+1} = u_j ^n - \frac{ a \Delta t}{\Delta x} (u_j ^n - u_{j-1} ^n)
</script>
</p>
<ol>
<li>We begin by specifying <script type="math/tex"> u_j ^0 = f(x_j) </script>, i.e. we populate the solution at <script type="math/tex"> t=0 </script>.</li>
<li>Sweep through the domain starting at <script type="math/tex"> j=1 </script> towards <script type="math/tex"> j=J </script>
<script type="math/tex; mode=display">
    u_1 ^{n+1} = u_1 ^n - \frac{a \Delta t}{\Delta x} (u_1 ^n - u_0 ^n)
    </script>
    where
    <script type="math/tex; mode=display">
    u_0 ^n = g_D(t^n)
    </script>
</li>
<li>Notice, at <script type="math/tex"> j=J </script>
<script type="math/tex; mode=display">
    u_J ^{n+1} = u_J ^n - \frac{a \Delta t}{\Delta x} (u_J ^n - u_{J-1} ^n)
    </script>
    There is no boundary condition required since there is no data required from outside of our domain. If we do require such data, we'll need to do something special here.</li>
</ol>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ch21-3/" title="21.3 - Finite Difference and Finite Volume Methods" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                21.3 - Finite Difference and Finite Volume Methods
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.2ba8dec4.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../extra.js"></script>
      
    
  </body>
</html>