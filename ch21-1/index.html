



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>21.1 - Finite Difference Algorithms - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700|IBM+Plex+Mono">
        <style>body,input{font-family:"IBM Plex Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"IBM Plex Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/dark_theme.css">
    
      <link rel="stylesheet" href="../stylesheets/codehilite.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#211-finite-difference-algorithms" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="My Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon">book</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              My Docs
            </span>
            <span class="md-header-nav__topic">
              21.1 - Finite Difference Algorithms
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/PeppyHare/pf-notes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PeppyHare/pf-notes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="My Docs" class="md-nav__button md-logo">
      
        <i class="md-icon">book</i>
      
    </a>
    My Docs
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/PeppyHare/pf-notes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PeppyHare/pf-notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      1 - The Plasma State
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        1 - The Plasma State
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch1-1/" title="1.1 - Definition of Plasma" class="md-nav__link">
      1.1 - Definition of Plasma
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch1-2/" title="1.2 - Particle motion in EM fields" class="md-nav__link">
      1.2 - Particle motion in EM fields
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      10 - Background Review
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        10 - Background Review
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-1/" title="10.1 - Statistical Mechanics" class="md-nav__link">
      10.1 - Statistical Mechanics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch10-2/" title="10.2 - Review of E&M" class="md-nav__link">
      10.2 - Review of E&M
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Introduction to Compressible CFD
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Introduction to Compressible CFD
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-1/" title="20.1 - Introduction" class="md-nav__link">
      20.1 - Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-2/" title="20.2 - Governing Equations" class="md-nav__link">
      20.2 - Governing Equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-3/" title="20.3 - Reduced Models" class="md-nav__link">
      20.3 - Reduced Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-4/" title="20.4 - Equation Types" class="md-nav__link">
      20.4 - Equation Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ch20-5/" title="20.5 - Panel Method" class="md-nav__link">
      20.5 - Panel Method
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Finite Differencing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Finite Differencing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        21.1 - Finite Difference Algorithms
      </label>
    
    <a href="./" title="21.1 - Finite Difference Algorithms" class="md-nav__link md-nav__link--active">
      21.1 - Finite Difference Algorithms
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definitions" title="Definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accuracy" title="Accuracy" class="md-nav__link">
    Accuracy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithm-requirements" title="Algorithm Requirements" class="md-nav__link">
    Algorithm Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#consistency" title="Consistency" class="md-nav__link">
    Consistency
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stability" title="Stability" class="md-nav__link">
    Stability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence" title="Convergence" class="md-nav__link">
    Convergence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accuracy_1" title="Accuracy" class="md-nav__link">
    Accuracy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sources-of-errors" title="Sources of Errors?" class="md-nav__link">
    Sources of Errors?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definitions" title="Definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accuracy" title="Accuracy" class="md-nav__link">
    Accuracy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithm-requirements" title="Algorithm Requirements" class="md-nav__link">
    Algorithm Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#consistency" title="Consistency" class="md-nav__link">
    Consistency
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stability" title="Stability" class="md-nav__link">
    Stability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence" title="Convergence" class="md-nav__link">
    Convergence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accuracy_1" title="Accuracy" class="md-nav__link">
    Accuracy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sources-of-errors" title="Sources of Errors?" class="md-nav__link">
    Sources of Errors?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/PeppyHare/pf-notes/edit/master/docs/ch21-1.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="211-finite-difference-algorithms">21.1 Finite Difference Algorithms</h1>
<h2 id="definitions">Definitions</h2>
<p>By definition, <strong>Finite Differencing</strong> is a method to <em>approximate</em> partial differential equations which we cannot solve, into a system of algebraic equations which we can.</p>
<p>Notation to simplify our representations:</p>
<ul>
<li>Superscripts: We use superscripts to denote steps in the time domain <script type="math/tex"> t^n = n \Delta t </script>. Here <script type="math/tex"> n = [0, N] </script> is the step index and <script type="math/tex"> \Delta t </script> is the time-step <script type="math/tex"> T/N </script>
</li>
<li>Subscripts: <script type="math/tex"> x_j = j \Delta x </script>. Here <script type="math/tex"> j = [0, J] </script> is the step index and <script type="math/tex"> \Delta x = L/J </script> is the spatial step.</li>
<li>Together: <script type="math/tex"> u_j ^n = u(t^n, x_j) </script>
</li>
<li><strong>Explicit</strong> algorithms: Use data that is already known at the present time to advance the solution to the next time step. They are easier and faster to implement, but they introduce stability constraints.
    <script type="math/tex; mode=display">
    u_j ^{n+1} = f(u_j ^n, u_{j+1} ^n , u_{j+2} ^n \ldots)
    </script>
</li>
<li><strong>Implicit</strong> algorithms: Use data from the next time step when advancing the solution. Leads to a system of equations that must be solved simultaneously
    <script type="math/tex; mode=display">
    u_{j} ^{n+1} = f(u_{j} ^n , u_{j+1} ^{n+1}, u_{j-1} ^{n+1}, \ldots)
    </script>
</li>
</ul>
<p>One look at the typical definition of the derivative suggests an algebraic approximation</p>
<p>
<script type="math/tex; mode=display">
\dv{f}{x} = \lim_{\Delta x \rightarrow 0} \frac{f(x + \Delta x) - f(x)}{\Delta x} \quad \rightarrow \quad \dv{f}{x} \approx \frac{f(x + \Delta x) - f(x) }{\Delta x}
</script>
</p>
<p>Applying to our model equation, the linear advection equation</p>
<p>
<script type="math/tex; mode=display">
\pdv{u}{t} + c \pdv{u}{x} = 0
</script>
</p>
<p>The first-order forward difference approximation for the temporal derivative is
<script type="math/tex; mode=display">
\pdv{u}{t} \approx \frac{u_j ^{n+1} - u_j ^n}{\Delta t} \equiv \Delta _t u
</script>
And the first-order backward approximation for <script type="math/tex"> \pdv{u}{x} </script> is
<script type="math/tex; mode=display">
\pdv{u}{x} \approx \frac{u_{j} ^n - u_{j-1} ^n}{\Delta x} \equiv \nabla _x u
</script>
These are sometimes called Euler differencing, since they are first-order. Plugging in our approximations, we arrive at the "Forward Euler Algorithm"</p>
<p>
<script type="math/tex; mode=display">
\frac{u_{j} ^{n+1} u_j ^n}{\Delta t} + c \frac{u_{j} ^n - u_{j-1} ^n}{\Delta x} = 0
</script>
This is an explicit scheme: solve for <script type="math/tex"> u^{n+1} _j  </script>
<script type="math/tex; mode=display">
u_j ^{n+1} = u_j ^n - \frac{c \Delta t}{\Delta x} (u_j ^n - u_{j-1} ^n)
</script>
</p>
<p>The multiplier out front <script type="math/tex"> \frac{c \Delta t}{\Delta x} </script> is very important for stability, so we call it</p>
<p>
<script type="math/tex; mode=display">
\frac{c \Delta t}{\Delta x} = \text{ Courant number (or CFL number)}
</script>
</p>
<p>For the problem to be mathematically well-posed, we must know initial conditions and boundary conditions
<script type="math/tex; mode=display">
u(t = 0, j) \qquad u(t, x = 0)
</script>
</p>
<h2 id="accuracy">Accuracy</h2>
<p>We can be more precise with the error in our difference approximation: the error will be on the order of <script type="math/tex"> \Delta x </script>:</p>
<p>
<script type="math/tex; mode=display">
\dv{f}{x} \approx \frac{f(x + \Delta x) - f(x) }{\Delta x}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\rightarrow \dv{f}{x} = \frac{f(x + \Delta x) - f(x) }{\Delta x} + O(\Delta x)
</script>
</p>
<p>As it turns out, we can improve the accuracy of the finite difference operators by using centered differences:</p>
<p>
<script type="math/tex; mode=display">
\left. \pdv{u}{x} \right|_{j} = \frac{u_{j+1} ^n - u_{j-1} ^n}{2 \Delta x} + O(\Delta x ^2)
</script>
</p>
<p>So the forward-time, centered-space (FTCS) PDE becomes
<script type="math/tex; mode=display">
\frac{u_j ^{n+1} - u_j ^n}{\Delta t} + c \frac{u_{j+1} ^n - u_{j-1} ^n }{2 \Delta x} = 0
</script>
</p>
<p>This is more accurate than the Euler method in space. We can write the accuracy as <script type="math/tex"> O(\Delta t, \Delta x^2) </script>, or "it is first-order accurate in time and second-order accurate in space."</p>
<p>How do we get accuracy estimates? The accuracy is defined by using a Taylor series expansion for the finite-difference operators:</p>
<p>
<script type="math/tex; mode=display">
u_j ^{n+1} = u_j ^n + \pdv{u}{t} \Delta t + \frac{1}{2} \pdv{ ^2 u}{t^2} \Delta t^2 + \frac{1}{6} \pdv{ ^3 u}{t ^3} \Delta t^3 + \ldots
</script>
<script type="math/tex; mode=display">
u_{j+1} ^n = u_j ^n + \pdv{u}{x} \Delta x + \frac{1}{2} \pdv{ ^2 u}{x^2} \Delta x^2 + \frac{1}{6} \pdv{ ^3 u }{x ^3} \Delta x ^3 + \ldots
</script>
<script type="math/tex; mode=display">
u_{j-1} ^n = u_j ^n - \pdv{u}{x} \Delta x + \frac{1}{2} \pdv{ ^2 u }{x^2} \Delta x^2 - \frac{1}{6} \pdv{^3 u }{x^3} \Delta x ^3 + \ldots 
</script>
</p>
<p>Substituting into the Forward Euler algorithm:</p>
<p>
<script type="math/tex; mode=display">
u_j ^n + \pdv{u}{t} \Delta t + \frac{1}{2} \pdv{^2 u }{t^2} \Delta t^2 + \frac{1}{6} \pdv{ ^3 u}{t ^3} \Delta t^3 + \ldots
</script>
<script type="math/tex; mode=display">
= u_j ^n - \frac{c \Delta t}{\Delta x} \left( u_j ^n - \left[ u_j ^n - \pdv{u}{x} \Delta x + \pdv{^2 u }{x^2} \frac{\Delta x ^2}{2} \pm \ldots \right] \right)
</script>
</p>
<p>After simplifying and re-arranging/canceling like terms, we get</p>
<p>
<script type="math/tex; mode=display">
\pdv{u}{t} + c \pdv{u}{x} = - \frac{1}{2} \pdv{^2 u}{t^2} \Delta t - \frac{1}{6} \Delta t^2 + \ldots + \frac{c}{2} \pdv{^2 u}{x^2} \Delta x - \frac{c}{6} \pdv{ ^3 u }{x ^3} \Delta x ^2 + \ldots
</script>
</p>
<p>The left-hand side is the PDE we're trying to solve, so everything on the right-hand side is the error term introduced by our approximation. The solution we're going to get is actually the solution to the modified PDE with all of the error terms.  Reading off the lowest-order terms of <script type="math/tex"> \Delta x </script> and <script type="math/tex"> \Delta t </script> we see that the algorithm is first-order accurate in space and time.</p>
<h2 id="algorithm-requirements">Algorithm Requirements</h2>
<p>For an algorithm to work, it requires the following properties:</p>
<ol>
<li><strong>Consistency</strong>: Whatever finite difference operator <script type="math/tex"> \delta_x u </script> we use, applied to our solution, has to approximate the derivative as the spacing goes to zero
    <script type="math/tex; mode=display">
    \delta _x u \rightarrow \pdv{u}{x} \quad \text{ as } \quad \Delta x \rightarrow 0
    </script>
</li>
<li><strong>Stability</strong>: The solution must be bounded, so for some initial condition <script type="math/tex"> u </script> the norm goes to zero as the number of points goes to infinity
    <script type="math/tex; mode=display">
    |u_j - u| \rightarrow 0 \quad \text{ as } \quad I \rightarrow \infty
    </script>
</li>
<li><strong>Accuracy</strong>: The accuracy is bounded by the finite difference operator
    <script type="math/tex; mode=display">
    \pdv{u}{x} - \delta _x u = O(\Delta x ^m)
    </script>
</li>
<li><strong>Convergence</strong>: The numerical solution must approach the exact solution as the grid spacing goes to zero
    <script type="math/tex; mode=display">
    u_j \rightarrow u \quad \text{ as } \quad \Delta x \rightarrow 0
    </script>
</li>
</ol>
<p>A useful theorem is Lax's Theorem: <em>An algorithm that is consistent and stable will converge</em>. This means that we only have to prove consistency, stability, and accuracy.</p>
<h3 id="consistency">Consistency</h3>
<p>Let's take our Forward Euler algorithm as an example: From analyzing the accuracy, we derived the modified PDE and noted the leading-order error terms. Forward Euler gave <script type="math/tex"> O(\Delta x, \Delta t) </script>. As <script type="math/tex"> \Delta t, \Delta x \rightarrow 0 </script>, we recover the original PDE. Therefore, FE is consistent.</p>
<p>Likewise the FTCS is also consistent, since <script type="math/tex"> \Delta t, \Delta x \rightarrow 0 </script> also recovers the original PDE. In fact, because the accuracy of FTCS was <script type="math/tex"> O(\Delta x ^2, \Delta t) </script> it is also consistent.</p>
<h3 id="stability">Stability</h3>
<p>The way to perform the stability analysis is to use Fourier transforms to convert from a discrete spatial domain to a continuous frequency domain. Broadly speaking, the mathematical tools we have at our disposal to analyze stability only apply to continuous functions - you can't take a derivative of a set of discrete points. By transforming to a continuous domain, we can use properties of our basis functions to examine the growth of errors over time. This process is called <strong>Von Neumann Stability Analysis</strong>.</p>
<p>Example: Stability analysis of FTCS</p>
<p>
<script type="math/tex; mode=display">
u_j ^{n+1} = u_j ^n - \frac{a \Delta t}{2 \Delta x} \left( u_{j+1} ^n - u_{j-1} ^n \right)
</script>
</p>
<p>We define an error norm by subtracting the exact solution</p>
<p>
<script type="math/tex; mode=display">
\varepsilon_j ^n = u_j ^n - \overline{u}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\varepsilon_j ^{n+1} = \varepsilon_j ^n - \frac{a \Delta t}{2 \Delta x} \left( \varepsilon_{j+1} ^n - \varepsilon_{j-1} ^n \right)
</script>
</p>
<p>To study the evolution of the errors, apply a Fourier transform to get to frequency space:</p>
<p>
<script type="math/tex; mode=display">
\varepsilon_j ^n = V^n e^{ik_x x} = V^n e^{ik_x (j \Delta x)}
</script>
<script type="math/tex; mode=display">
V^n = \text{ wave amplitude}
</script>
<script type="math/tex; mode=display">
k = \text{ wavenumber } = \frac{2 \pi}{\lambda_x}
</script>
</p>
<p>Substituting, 
<script type="math/tex; mode=display">
V^{n+1} e^{i k_x j \Delta x} = V^n e^{i k_x j \Delta x} - \frac{a \Delta t}{2 \Delta x} \left(V^n e^{i k_x (j+1) \Delta x } - V^n e^{i k_x (j-1) \Delta x} \right)
</script>
<script type="math/tex; mode=display">
\rightarrow \frac{V^{n+1}}{V_n} = 1 - \frac{a \Delta t}{2 \Delta x} \left( e^{i k_x \Delta x} - e^{ik_x \Delta x} \right)
</script>
The ratio <script type="math/tex"> V^{n+1}/V^n </script> tells us how the amplitudes of the errors will evolve in time. We define the amplification factor <script type="math/tex"> G </script>
<script type="math/tex; mode=display">
G = \left| \frac{V^{n+1}}{V^n} \right|
</script>
For stability, we need the errors not to grow over time, so the Von Neumann stability criterion is:</p>
<p>
<script type="math/tex; mode=display">
G^m \leq 1 \quad \forall n
</script>
</p>
<p>Continuing with our example</p>
<p>
<script type="math/tex; mode=display">
\frac{V^{n+1}}{V_n} = 1 - \frac{a \Delta t}{2 \Delta x} \left[ \cos (k_x \Delta x) + i \sin(k \Delta x) - \cos (-k_x \Delta x) - i \sin (- k_x \Delta x) \right]
</script>
<script type="math/tex; mode=display">
= 1 - i \frac{ a \Delta t}{\Delta x} \sin (k_x \Delta x)
</script>
To get the amplification factor, we need the norm
<script type="math/tex; mode=display">
G = \left[ \left(1 - i \frac{ a \Delta t}{\Delta x} \sin (k_x \Delta x) \right) \left( 1 + i \frac{ a \Delta t}{\Delta x} \sin (k_x \Delta x)\right) \right] ^{1/2}
</script>
<script type="math/tex; mode=display">
= \sqrt{ 1 + \left( \frac{a \Delta t}{\Delta x} ^2 \sin ^2 (k_x \Delta x)\right)}
</script>
But that's always greater than 1! So FTCS is unconditionally unstable.</p>
<p>Performing the same analysis for Forward Euler, we get a stability condition:</p>
<p>
<script type="math/tex; mode=display">
0 \leq 1 + 2\frac{a \Delta t}{\Delta x} \left( \frac{a \Delta t}{ \Delta x} -1 \right) (1 - \cos (k_x \Delta x)) \leq 1
</script>
</p>
<p align="center"> <img alt="Figure 20.4" src="../img/20.4.png" /> </p>

<p>We can see that the CFL number must be</p>
<p>
<script type="math/tex; mode=display">
0 \leq \frac{a \Delta t}{\Delta x} \leq 1
</script>
Possible values of <script type="math/tex"> k_x \Delta x = \frac{2 \pi}{\lambda} \Delta x </script> . The minimum of <script type="math/tex"> k_x \Delta x </script> occurs at <script type="math/tex"> \lambda = \infty </script>, uniform error throughout the domain. This only occurs if the error is everywhere zero, since the boundary conditions are presumed accurate. In practice, the maximum wavelength is equal to twice the length of the domain
<script type="math/tex; mode=display">
\lambda_{max} = 2L
</script>
<script type="math/tex; mode=display">
(k_x \Delta x)_{max} = \frac{\pi}{J-1}
</script>
</p>
<p>The maximum of <script type="math/tex"> k_x \Delta x </script> is for <script type="math/tex"> \lambda = 0 </script>, but this is not possible on a grid with finite grid points. The Nyquist limit tells us that <script type="math/tex"> \lambda_{min} = 2 \Delta x </script>. That means that</p>
<p>
<script type="math/tex; mode=display">
(k_x \Delta x)_{max} = \pi
</script>
</p>
<p>When you violate a stability condition, what do we expect to see? The error growth is largest for the largest value of <script type="math/tex"> k_x \Delta x </script>, which corresponds to a wavelength equal to the grid spacing. In practice, that looks like errors that blow up from point to point.</p>
<h3 id="convergence">Convergence</h3>
<p>We want to show that the numerical solution approaches the exact solution to the original PDE.</p>
<p>Lax's equivalence theorem states:</p>
<p>If an algorithm is consistent and stability requirements are satisfied, the numerical solution will converge to the solution of the original PDE.</p>
<p>This is why consistency and stability is so important; if you have both, then you have convergence, which tells you that the problem you're solving is the problem you are actually trying to solve.</p>
<h3 id="accuracy_1">Accuracy</h3>
<p>The solution exists at discrete locations for multiple variables, e.g <script type="math/tex"> \rho, p, u, v, \ldots </script>, so we want a convenient measure of solution accuracy.</p>
<p>The general p-norm is defined as</p>
<p>
<script type="math/tex; mode=display">
\text{p-norm} = L_p =  \left[\sum_{j=1} ^J |z|^p \right]^{1/p}
</script>
</p>
<p>In practice, the most common norms that we use are the 1, 2, or <script type="math/tex"> \infty </script>-norms.</p>
<p>
<script type="math/tex; mode=display">
L_1 = \sum |z| \quad \text{(average)}
</script>
</p>
<p>
<script type="math/tex; mode=display">
L_2 = \left[ \sum |z|^2 \right]^{1/2} \quad \text{(variance)}
</script>
</p>
<p>
<script type="math/tex; mode=display">
L_{\infty} = \text{max}|z| \quad \text{(max-norm)}
</script>
</p>
<p>In practice, the 2-norm is the most rigorous definition of the error. Specifically, we define the error norm in the form</p>
<p>
<script type="math/tex; mode=display">
\text{Error norm} = \left[ \sum_{j=1} ^{J} \Delta x ( \varepsilon) ^2 \right] ^{1/2} = \sqrt{\Delta x} || \varepsilon ||_2
</script>
<script type="math/tex; mode=display">
\varepsilon_j = u_j - \overline{u}
</script>
</p>
<h3 id="sources-of-errors">Sources of Errors?</h3>
<p>Where do errors come from? In order to reduce our model's error, we must first understand where the errors come from.</p>
<p><strong>Truncation errors</strong> - Result from the terms in the Taylor series difference approximation that are neglected. They can be reduced by using higher accuracy difference operators.</p>
<p><strong>Round-off errors</strong> - Result of the limited machine accuracy (accuracy of floating point representation). It can be reduced by using higher precision to store values, <em>or</em> by performing fewer calculations.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ch20-5/" title="20.5 - Panel Method" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                20.5 - Panel Method
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.2ba8dec4.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../extra.js"></script>
      
    
  </body>
</html>